axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs1
p_sbs1 <- p_sbs1 + theme(legend.text = ggtext::element_textbox(width = unit(10, "lines")))
p_sbs5 <- p_sbs5 + theme(legend.text = ggtext::element_textbox(width = unit(10, "lines")))
p_sbs18 <- p_sbs18 + theme(legend.text = ggtext::element_textbox(width = unit(10, "lines")))
sbs_plot<-ggarrange(p_sbs1,p_sbs5,p_sbs18,
ncol = 3, nrow=1, common.legend = TRUE, legend = "bottom",  align = "v")
p_sbs1
full_dataset = rbind(database,ctrl_database)
full_dataset=full_dataset[full_dataset$coverage>=10,]
full_dataset$group = 'Control'
full_dataset$group[!is.na(full_dataset$germlinehit)] = 'FAP'
full_dataset = full_dataset[!full_dataset$type %in% c('polyp','large polyp'),]
full_dataset$num_drivers = 3-(is.na(full_dataset$somatic1)+is.na(full_dataset$somatic2)+is.na(full_dataset$germlinehit))
df = full_dataset
df$type[df$group == 'Control'] = 'Normal crypts, Control, APC wt/wt'
df$type[df$num_drivers>1 & df$type=='normal'] = 'Normal crypts, FAP, APC mut/mut'
df$type[df$group=='FAP' & df$type=='normal' & is.na(df$trapped_in_polyp)] = 'Normal crypts, FAP, APC mut/wt'
df$type[df$type=='acf' & df$num_drivers>1] = 'ACF, FAP, APC mut/mut'
df$type[df$type %in% c('polyp','large polyp')] = 'Polyps, FAP'
df$type[(df$num_drivers<2) & df$type %in% c('acf','normal') & !is.na(df$trapped_in_polyp)]='Bystander crypts, FAP, APC mut/wt'
df$type[(df$num_drivers<2) & df$type %in% c('acf')]='Bystander crypts, FAP, APC mut/wt'
df = df[df$type!='Polyps, FAP',]
df$type = factor(df$type, levels = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' ))
dot_cols = c("#DF5B3F", "#F5B46F", "#3E517A","#70A3C4", "#C7E5EC")
names(dot_cols) = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' )
labels_parse <- c(
"ACF*','~FAP*',\n'~italic(APC)^{mut/mut}",
"Normal~crypts*','~FAP*',\n'~italic(APC)^{mut/mut}",
"Bystander~crypts*','~FAP*',\n'~italic(APC)^{mut/wt}",
"Normal~crypts*','~FAP*',\n'~italic(APC)^{mut/wt}",
"Normal~crypts*','~Control*',\n'~italic(APC)^{wt/wt}"
)
p_sbs1 = ggplot(data = df, mapping = aes(x = age, y = SBS1)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs1
p_sbs1
labels_parse <- c(
"ACF*','~FAP*',\n'~italic(APC)^{mut/mut}",
"Normal~crypts*','~FAP*',\n'~italic(APC)^{mut/mut}",
"Bystander~crypts*','~FAP*',\n'~italic(APC)^{mut/wt}",
"Normal~crypts*','~FAP*',\n'~italic(APC)^{mut/wt}",
"Normal~crypts*','~Control*',\n'~italic(APC)^{wt/wt}"
)
p_sbs1 = ggplot(data = df, mapping = aes(x = age, y = SBS1)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs1
full_dataset = rbind(database,ctrl_database)
full_dataset=full_dataset[full_dataset$coverage>=10,]
full_dataset$group = 'Control'
full_dataset$group[!is.na(full_dataset$germlinehit)] = 'FAP'
full_dataset = full_dataset[!full_dataset$type %in% c('polyp','large polyp'),]
full_dataset$num_drivers = 3-(is.na(full_dataset$somatic1)+is.na(full_dataset$somatic2)+is.na(full_dataset$germlinehit))
df = full_dataset
df$type[df$group == 'Control'] = 'Normal crypts, Control, APC wt/wt'
df$type[df$num_drivers>1 & df$type=='normal'] = 'Normal crypts, FAP, APC mut/mut'
df$type[df$group=='FAP' & df$type=='normal' & is.na(df$trapped_in_polyp)] = 'Normal crypts, FAP, APC mut/wt'
df$type[df$type=='acf' & df$num_drivers>1] = 'ACF, FAP, APC mut/mut'
df$type[df$type %in% c('polyp','large polyp')] = 'Polyps, FAP'
df$type[(df$num_drivers<2) & df$type %in% c('acf','normal') & !is.na(df$trapped_in_polyp)]='Bystander crypts, FAP, APC mut/wt'
df$type[(df$num_drivers<2) & df$type %in% c('acf')]='Bystander crypts, FAP, APC mut/wt'
df = df[df$type!='Polyps, FAP',]
df$type = factor(df$type, levels = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' ))
dot_cols = c("#DF5B3F", "#F5B46F", "#3E517A","#70A3C4", "#C7E5EC")
names(dot_cols) = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' )
labels_parse <- c(
"ACF*','~FAP*','~italic(APC)^{mut/mut}",
"Normal~crypts*','~FAP*','*'\n'*italic(APC)^{mut/mut}",
"Bystander~crypts*','~FAP*','*'\n'*italic(APC)^{mut/wt}",
"Normal~crypts*','~FAP*','*'\n'*italic(APC)^{mut/wt}",
"Normal~crypts*','~Control*','*'\n'*italic(APC)^{wt/wt}"
)
p_sbs1 = ggplot(data = df, mapping = aes(x = age, y = SBS1)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs1
full_dataset = rbind(database,ctrl_database)
full_dataset=full_dataset[full_dataset$coverage>=10,]
full_dataset$group = 'Control'
full_dataset$group[!is.na(full_dataset$germlinehit)] = 'FAP'
full_dataset = full_dataset[!full_dataset$type %in% c('polyp','large polyp'),]
full_dataset$num_drivers = 3-(is.na(full_dataset$somatic1)+is.na(full_dataset$somatic2)+is.na(full_dataset$germlinehit))
df = full_dataset
df$type[df$group == 'Control'] = 'Normal crypts, Control, APC wt/wt'
df$type[df$num_drivers>1 & df$type=='normal'] = 'Normal crypts, FAP, APC mut/mut'
df$type[df$group=='FAP' & df$type=='normal' & is.na(df$trapped_in_polyp)] = 'Normal crypts, FAP, APC mut/wt'
df$type[df$type=='acf' & df$num_drivers>1] = 'ACF, FAP, APC mut/mut'
df$type[df$type %in% c('polyp','large polyp')] = 'Polyps, FAP'
df$type[(df$num_drivers<2) & df$type %in% c('acf','normal') & !is.na(df$trapped_in_polyp)]='Bystander crypts, FAP, APC mut/wt'
df$type[(df$num_drivers<2) & df$type %in% c('acf')]='Bystander crypts, FAP, APC mut/wt'
df = df[df$type!='Polyps, FAP',]
df$type = factor(df$type, levels = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' ))
dot_cols = c("#DF5B3F", "#F5B46F", "#3E517A","#70A3C4", "#C7E5EC")
names(dot_cols) = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' )
labels_parse <- c(
"ACF*','~FAP*','*'\n'*italic(APC)^{mut/mut}",
"Normal~crypts*','~FAP*','*'\n'*italic(APC)^{mut/mut}",
"Bystander~crypts*','~FAP*','*'\n'*italic(APC)^{mut/wt}",
"Normal~crypts*','~FAP*','*'\n'*italic(APC)^{mut/wt}",
"Normal~crypts*','~Control*','*'\n'*italic(APC)^{wt/wt}"
)
p_sbs1 = ggplot(data = df, mapping = aes(x = age, y = SBS1)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs1
p_sbs5 = ggplot(data = df, mapping = aes(x = age, y = SBS5)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
axis.line = element_line(size = 0.5, colour = "black"),legend.text = ggtext::element_textbox(width = unit(10, "lines"))) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs5 = ggplot(data = df, mapping = aes(x = age, y = SBS5)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
axis.line = element_line(size = 0.5, colour = "black"),legend.text = ggtext::element_textbox(width = unit(10, "lines"))) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs5 = ggplot(data = df, mapping = aes(x = age, y = SBS5)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
axis.line = element_line(size = 0.5, colour = "black"),l) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs5 = ggplot(data = df, mapping = aes(x = age, y = SBS5)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs5
p_sbs18 = ggplot(data = df, mapping = aes(x = age, y = SBS18)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs18
sbs_plot<-ggarrange(p_sbs1,p_sbs5,p_sbs18,
ncol = 3, nrow=1, common.legend = TRUE, legend = "bottom",  align = "v")
sbs_plot
labels_parse <- c(
"ACF*','~FAP*','~italic(APC)^{mut/mut}~phantom('1234567890')",
"Normal~crypts*','~FAP*','~italic(APC)^{mut/mut}",
"Bystander~crypts*','~FAP*','~italic(APC)^{mut/wt}",
"Normal~crypts*','~FAP*','~italic(APC)^{mut/wt}",
"Normal~crypts*','~Control*','~italic(APC)^{wt/wt}"
)
p_sbs1 = ggplot(data = df, mapping = aes(x = age, y = SBS1)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs1
p_sbs5 = ggplot(data = df, mapping = aes(x = age, y = SBS5)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs5
p_sbs18 = ggplot(data = df, mapping = aes(x = age, y = SBS18)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs18
sbs_plot<-ggarrange(p_sbs1,p_sbs5,p_sbs18,
ncol = 3, nrow=1, common.legend = TRUE, legend = "bottom",  align = "v")
sbs_plot
full_dataset = rbind(database,ctrl_database)
full_dataset=full_dataset[full_dataset$coverage>=10,]
full_dataset$group = 'Control'
full_dataset$group[!is.na(full_dataset$germlinehit)] = 'FAP'
full_dataset = full_dataset[!full_dataset$type %in% c('polyp','large polyp'),]
full_dataset$num_drivers = 3-(is.na(full_dataset$somatic1)+is.na(full_dataset$somatic2)+is.na(full_dataset$germlinehit))
df = full_dataset
df$type[df$group == 'Control'] = 'Normal crypts, Control, APC wt/wt'
df$type[df$num_drivers>1 & df$type=='normal'] = 'Normal crypts, FAP, APC mut/mut'
df$type[df$group=='FAP' & df$type=='normal' & is.na(df$trapped_in_polyp)] = 'Normal crypts, FAP, APC mut/wt'
df$type[df$type=='acf' & df$num_drivers>1] = 'ACF, FAP, APC mut/mut'
df$type[df$type %in% c('polyp','large polyp')] = 'Polyps, FAP'
df$type[(df$num_drivers<2) & df$type %in% c('acf','normal') & !is.na(df$trapped_in_polyp)]='Bystander crypts, FAP, APC mut/wt'
df$type[(df$num_drivers<2) & df$type %in% c('acf')]='Bystander crypts, FAP, APC mut/wt'
df = df[df$type!='Polyps, FAP',]
df$type = factor(df$type, levels = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' ))
dot_cols = c("#DF5B3F", "#F5B46F", "#3E517A","#70A3C4", "#C7E5EC")
names(dot_cols) = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' )
labels_parse <- c(
"ACF*','~FAP*','~italic(APC)^{mut/mut}~phantom('1234567890')",
"Normal~crypts*','~FAP*','~italic(APC)^{mut/mut}",
"Bystander~crypts*','~FAP*','~italic(APC)^{mut/wt}",
"Normal~crypts*','~FAP*','~italic(APC)^{mut/wt}",
"Normal~crypts*','~Control*','~italic(APC)^{wt/wt}"
)
p_sbs1 = ggplot(data = df, mapping = aes(x = age, y = SBS1)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
legend.box = "horizontal",axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs1
p_sbs5 = ggplot(data = df, mapping = aes(x = age, y = SBS5)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
legend.box = "horizontal",axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs5
p_sbs18 = ggplot(data = df, mapping = aes(x = age, y = SBS18)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
legend.box = "horizontal",axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs18
sbs_plot<-ggarrange(p_sbs1,p_sbs5,p_sbs18,
ncol = 3, nrow=1, common.legend = TRUE, legend = "bottom",  align = "v")
sbs_plot
full_dataset = rbind(database,ctrl_database)
full_dataset=full_dataset[full_dataset$coverage>=10,]
full_dataset$group = 'Control'
full_dataset$group[!is.na(full_dataset$germlinehit)] = 'FAP'
full_dataset = full_dataset[!full_dataset$type %in% c('polyp','large polyp'),]
full_dataset$num_drivers = 3-(is.na(full_dataset$somatic1)+is.na(full_dataset$somatic2)+is.na(full_dataset$germlinehit))
df = full_dataset
df$type[df$group == 'Control'] = 'Normal crypts, Control, APC wt/wt'
df$type[df$num_drivers>1 & df$type=='normal'] = 'Normal crypts, FAP, APC mut/mut'
df$type[df$group=='FAP' & df$type=='normal' & is.na(df$trapped_in_polyp)] = 'Normal crypts, FAP, APC mut/wt'
df$type[df$type=='acf' & df$num_drivers>1] = 'ACF, FAP, APC mut/mut'
df$type[df$type %in% c('polyp','large polyp')] = 'Polyps, FAP'
df$type[(df$num_drivers<2) & df$type %in% c('acf','normal') & !is.na(df$trapped_in_polyp)]='Bystander crypts, FAP, APC mut/wt'
df$type[(df$num_drivers<2) & df$type %in% c('acf')]='Bystander crypts, FAP, APC mut/wt'
df = df[df$type!='Polyps, FAP',]
df$type = factor(df$type, levels = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' ))
dot_cols = c("#DF5B3F", "#F5B46F", "#3E517A","#70A3C4", "#C7E5EC")
names(dot_cols) = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' )
labels_parse <- c(
"ACF*','~FAP*','~italic(APC)^{mut/mut}~phantom('1234567890')",
"Normal~crypts*','~FAP*','~italic(APC)^{mut/mut}",
"Bystander~crypts*','~FAP*','~italic(APC)^{mut/wt}",
"Normal~crypts*','~FAP*','~italic(APC)^{mut/wt}",
"Normal~crypts*','~Control*','~italic(APC)^{wt/wt}"
)
p_sbs1 = ggplot(data = df, mapping = aes(x = age, y = SBS1)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
legend.position = "bottom",legend.box = "horizontal",legend.text = element_text(size = 8),
axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs1
full_dataset = rbind(database,ctrl_database)
full_dataset=full_dataset[full_dataset$coverage>=10,]
full_dataset$group = 'Control'
full_dataset$group[!is.na(full_dataset$germlinehit)] = 'FAP'
full_dataset = full_dataset[!full_dataset$type %in% c('polyp','large polyp'),]
full_dataset$num_drivers = 3-(is.na(full_dataset$somatic1)+is.na(full_dataset$somatic2)+is.na(full_dataset$germlinehit))
df = full_dataset
df$type[df$group == 'Control'] = 'Normal crypts, Control, APC wt/wt'
df$type[df$num_drivers>1 & df$type=='normal'] = 'Normal crypts, FAP, APC mut/mut'
df$type[df$group=='FAP' & df$type=='normal' & is.na(df$trapped_in_polyp)] = 'Normal crypts, FAP, APC mut/wt'
df$type[df$type=='acf' & df$num_drivers>1] = 'ACF, FAP, APC mut/mut'
df$type[df$type %in% c('polyp','large polyp')] = 'Polyps, FAP'
df$type[(df$num_drivers<2) & df$type %in% c('acf','normal') & !is.na(df$trapped_in_polyp)]='Bystander crypts, FAP, APC mut/wt'
df$type[(df$num_drivers<2) & df$type %in% c('acf')]='Bystander crypts, FAP, APC mut/wt'
df = df[df$type!='Polyps, FAP',]
df$type = factor(df$type, levels = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' ))
dot_cols = c("#DF5B3F", "#F5B46F", "#3E517A","#70A3C4", "#C7E5EC")
names(dot_cols) = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' )
labels_parse <- c(
"ACF*','~FAP*','~italic(APC)^{mut/mut}~phantom('123456789000000000')",
"Normal~crypts*','~FAP*','~italic(APC)^{mut/mut}",
"Bystander~crypts*','~FAP*','~italic(APC)^{mut/wt}",
"Normal~crypts*','~FAP*','~italic(APC)^{mut/wt}",
"Normal~crypts*','~Control*','~italic(APC)^{wt/wt}"
)
p_sbs1 = ggplot(data = df, mapping = aes(x = age, y = SBS1)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
legend.position = "bottom",legend.box = "horizontal",legend.text = element_text(size = 8),
axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
p_sbs1
full_dataset = rbind(database,ctrl_database)
full_dataset=full_dataset[full_dataset$coverage>=10,]
full_dataset$group = 'Control'
full_dataset$group[!is.na(full_dataset$germlinehit)] = 'FAP'
full_dataset = full_dataset[!full_dataset$type %in% c('polyp','large polyp'),]
full_dataset$num_drivers = 3-(is.na(full_dataset$somatic1)+is.na(full_dataset$somatic2)+is.na(full_dataset$germlinehit))
df = full_dataset
df$type[df$group == 'Control'] = 'Normal crypts, Control, APC wt/wt'
df$type[df$num_drivers>1 & df$type=='normal'] = 'Normal crypts, FAP, APC mut/mut'
df$type[df$group=='FAP' & df$type=='normal' & is.na(df$trapped_in_polyp)] = 'Normal crypts, FAP, APC mut/wt'
df$type[df$type=='acf' & df$num_drivers>1] = 'ACF, FAP, APC mut/mut'
df$type[df$type %in% c('polyp','large polyp')] = 'Polyps, FAP'
df$type[(df$num_drivers<2) & df$type %in% c('acf','normal') & !is.na(df$trapped_in_polyp)]='Bystander crypts, FAP, APC mut/wt'
df$type[(df$num_drivers<2) & df$type %in% c('acf')]='Bystander crypts, FAP, APC mut/wt'
df = df[df$type!='Polyps, FAP',]
df$type = factor(df$type, levels = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' ))
dot_cols = c("#DF5B3F", "#F5B46F", "#3E517A","#70A3C4", "#C7E5EC")
names(dot_cols) = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' )
labels_parse <- c(
"ACF, FAP,<br><i>APC</i><sup>mut/mut</sup>",
"Normal crypts, FAP,<br><i>APC</i><sup>mut/mut</sup>",
"Bystander crypts, FAP,<br><i>APC</i><sup>mut/wt</sup>",
"Normal crypts, FAP,<br><i>APC</i><sup>mut/wt</sup>",
"Normal crypts, Control,<br><i>APC</i><sup>wt/wt</sup>"
)
p_sbs1 = ggplot(data = df, mapping = aes(x = age, y = SBS1)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
legend.text = ggtext::element_markdown(size = 8),
full_dataset = rbind(database,ctrl_database)
full_dataset=full_dataset[full_dataset$coverage>=10,]
full_dataset$group = 'Control'
full_dataset$group[!is.na(full_dataset$germlinehit)] = 'FAP'
full_dataset = full_dataset[!full_dataset$type %in% c('polyp','large polyp'),]
full_dataset$num_drivers = 3-(is.na(full_dataset$somatic1)+is.na(full_dataset$somatic2)+is.na(full_dataset$germlinehit))
df = full_dataset
df$type[df$group == 'Control'] = 'Normal crypts, Control, APC wt/wt'
df$type[df$num_drivers>1 & df$type=='normal'] = 'Normal crypts, FAP, APC mut/mut'
df$type[df$group=='FAP' & df$type=='normal' & is.na(df$trapped_in_polyp)] = 'Normal crypts, FAP, APC mut/wt'
df$type[df$type=='acf' & df$num_drivers>1] = 'ACF, FAP, APC mut/mut'
df$type[df$type %in% c('polyp','large polyp')] = 'Polyps, FAP'
df$type[(df$num_drivers<2) & df$type %in% c('acf','normal') & !is.na(df$trapped_in_polyp)]='Bystander crypts, FAP, APC mut/wt'
df$type[(df$num_drivers<2) & df$type %in% c('acf')]='Bystander crypts, FAP, APC mut/wt'
df = df[df$type!='Polyps, FAP',]
df$type = factor(df$type, levels = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' ))
dot_cols = c("#DF5B3F", "#F5B46F", "#3E517A","#70A3C4", "#C7E5EC")
names(dot_cols) = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' )
labels_parse <- c(
"ACF, FAP,<br><i>APC</i><sup>mut/mut</sup>",
"Normal crypts, FAP,<br><i>APC</i><sup>mut/mut</sup>",
"Bystander crypts, FAP,<br><i>APC</i><sup>mut/wt</sup>",
"Normal crypts, FAP,<br><i>APC</i><sup>mut/wt</sup>",
"Normal crypts, Control,<br><i>APC</i><sup>wt/wt</sup>"
)
p_sbs1 = ggplot(data = df, mapping = aes(x = age, y = SBS1)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = parse(text = labels_parse))+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
legend.text = ggtext::element_markdown(size = 8),
axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
full_dataset = rbind(database,ctrl_database)
full_dataset=full_dataset[full_dataset$coverage>=10,]
full_dataset$group = 'Control'
full_dataset$group[!is.na(full_dataset$germlinehit)] = 'FAP'
full_dataset = full_dataset[!full_dataset$type %in% c('polyp','large polyp'),]
full_dataset$num_drivers = 3-(is.na(full_dataset$somatic1)+is.na(full_dataset$somatic2)+is.na(full_dataset$germlinehit))
df = full_dataset
df$type[df$group == 'Control'] = 'Normal crypts, Control, APC wt/wt'
df$type[df$num_drivers>1 & df$type=='normal'] = 'Normal crypts, FAP, APC mut/mut'
df$type[df$group=='FAP' & df$type=='normal' & is.na(df$trapped_in_polyp)] = 'Normal crypts, FAP, APC mut/wt'
df$type[df$type=='acf' & df$num_drivers>1] = 'ACF, FAP, APC mut/mut'
df$type[df$type %in% c('polyp','large polyp')] = 'Polyps, FAP'
df$type[(df$num_drivers<2) & df$type %in% c('acf','normal') & !is.na(df$trapped_in_polyp)]='Bystander crypts, FAP, APC mut/wt'
df$type[(df$num_drivers<2) & df$type %in% c('acf')]='Bystander crypts, FAP, APC mut/wt'
df = df[df$type!='Polyps, FAP',]
df$type = factor(df$type, levels = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' ))
dot_cols = c("#DF5B3F", "#F5B46F", "#3E517A","#70A3C4", "#C7E5EC")
names(dot_cols) = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' )
labels_html <- c(
"ACF, FAP,<br><i>APC</i><sup>mut/mut</sup>",
"Normal crypts, FAP,<br><i>APC</i><sup>mut/mut</sup>",
"Bystander crypts, FAP,<br><i>APC</i><sup>mut/wt</sup>",
"Normal crypts, FAP,<br><i>APC</i><sup>mut/wt</sup>",
"Normal crypts, Control,<br><i>APC</i><sup>wt/wt</sup>"
)
p_sbs1 = ggplot(data = df, mapping = aes(x = age, y = SBS1)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = labels_html)+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
legend.text = ggtext::element_markdown(size = 8),
axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8))
full_dataset = rbind(database,ctrl_database)
full_dataset=full_dataset[full_dataset$coverage>=10,]
full_dataset$group = 'Control'
full_dataset$group[!is.na(full_dataset$germlinehit)] = 'FAP'
full_dataset = full_dataset[!full_dataset$type %in% c('polyp','large polyp'),]
full_dataset$num_drivers = 3-(is.na(full_dataset$somatic1)+is.na(full_dataset$somatic2)+is.na(full_dataset$germlinehit))
df = full_dataset
df$type[df$group == 'Control'] = 'Normal crypts, Control, APC wt/wt'
df$type[df$num_drivers>1 & df$type=='normal'] = 'Normal crypts, FAP, APC mut/mut'
df$type[df$group=='FAP' & df$type=='normal' & is.na(df$trapped_in_polyp)] = 'Normal crypts, FAP, APC mut/wt'
df$type[df$type=='acf' & df$num_drivers>1] = 'ACF, FAP, APC mut/mut'
df$type[df$type %in% c('polyp','large polyp')] = 'Polyps, FAP'
df$type[(df$num_drivers<2) & df$type %in% c('acf','normal') & !is.na(df$trapped_in_polyp)]='Bystander crypts, FAP, APC mut/wt'
df$type[(df$num_drivers<2) & df$type %in% c('acf')]='Bystander crypts, FAP, APC mut/wt'
df = df[df$type!='Polyps, FAP',]
df$type = factor(df$type, levels = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' ))
dot_cols = c("#DF5B3F", "#F5B46F", "#3E517A","#70A3C4", "#C7E5EC")
names(dot_cols) = c('ACF, FAP, APC mut/mut', 'Normal crypts, FAP, APC mut/mut','Bystander crypts, FAP, APC mut/wt', 'Normal crypts, FAP, APC mut/wt','Normal crypts, Control, APC wt/wt' )
labels_html <- c(
"ACF, FAP,<br><i>APC</i><sup>mut/mut</sup>",
"Normal crypts, FAP,<br><i>APC</i><sup>mut/mut</sup>",
"Bystander crypts, FAP,<br><i>APC</i><sup>mut/wt</sup>",
"Normal crypts, FAP,<br><i>APC</i><sup>mut/wt</sup>",
"Normal crypts, Control,<br><i>APC</i><sup>wt/wt</sup>"
)
p_sbs1 = ggplot(data = df, mapping = aes(x = age, y = SBS1)) +
# geom_point(aes(colour = type), size = 0.5, alpha = 0.6) +
geom_jitter(aes(colour = type), width = 0.3, height = 0, alpha = 0.8, size = 0.5) +
scale_color_manual(name = "Group", values = dot_cols, labels = labels_html)+
theme_bw() + theme(panel.grid = element_blank(), panel.border = element_blank(),
axis.line = element_line(size = 0.5, colour = "black")) +
labs(y = "Substitutions / crypt",
x = "Age (yrs)") + theme(title = element_text(size = 8), axis.text.y = element_text(size = 8,
color = "black"), axis.text.x = element_text(size = 8, color = "black"),
legend.text = ggtext::element_markdown(size = 8))
p_sbs1
p_sbs1
p_sbs1
